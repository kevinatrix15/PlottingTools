%% Fits Gaus2 function to experimental temperature data
function hxy = Gauss2Eq2D_funFit(p, xydata)

% fx = p(1)*exp(-((xdata-p(2))/p(3)).^2) + p(4)*exp(-((xdata-p(5))/p(6)).^2) + p(7);
% fy = p(1)*exp(-((xdata-p(2))/p(3)).^2) + p(4)*exp(-((xdata-p(5))/p(6)).^2) + p(7);
a1x = p(1); b1x = p(2); c1x = p(3); 
a2x = p(4); b2x = p(5); c2x = p(6);
a1y = p(7); b1y = p(8); c1y = p(9); 
a2y = p(10); b2y = p(11); c2y = p(12);
d = p(13);

hxy = a1x*exp(-((xydata(:,1)-b1x)/c1x).^2 - ((xydata(:,2)-b1y)/c1y).^2) ...
    + a2y*exp(-((xydata(:,1)-b1x)/c1x).^2 - ((xydata(:,2)-b2y)/c2y).^2) ...
    + a1y*exp(-((xydata(:,1)-b2x)/c2x).^2 - ((xydata(:,2)-b1y)/c1y).^2) ...
    + a2x*exp(-((xydata(:,1)-b2x)/c2x).^2 - ((xydata(:,2)-b2y)/c2y).^2) ...
    + d;

% hxy = a1x*exp(-((xdata-b1x)/c1x).^2 - ((ydata-b1y)/c1y).^2) ...
%     + a2y*exp(-((xdata-b1x)/c1x).^2 - ((ydata-b2y)/c2y).^2) ...
%     + a1y*exp(-((xdata-b2x)/c2x).^2 - ((ydata-b1y)/c1y).^2) ...
%     + a2x*exp(-((xdata-b2x)/c2x).^2 - ((ydata-b2y)/c2y).^2) ...
%     + d;